<div
  class="fixed  <%= Current.user.admin? ? "bg-primary-500" : "bg-white" %> p-2 w-full flex flex-shrink-0 items-center z-50 px-4 lg:px-4 border-b space-x-4 lg:space-x-0 h-16 <%= 'print:hidden' if Avo.configuration.hide_layout_when_printing %>"
  v-if="layout !== 'blank'"
>
  <div class="flex items-center space-x-2 w-auto lg:w-64 flex-shrink-0 h-full">
    <div>
      <%= a_button class: 'lg:hidden', icon: 'menu', size: :xs, compact: true, style: :text, data: { action: 'click->sidebar#toggleSidebarOnMobile' } %>
      <%= a_button class: 'hidden lg:block', icon: 'menu', size: :xs, compact: true, style: :text, data: { action: 'click->sidebar#toggleSidebar' } %>
    </div>
    <%= render partial: "avo/partials/logo" %>
  </div>

  <div class="flex-1 flex items-start justify-between lg:justify-start space-x-2 sm:space-x-8 lg:pl-4">
    <div class="flex">
      <%= render partial: "avo/partials/global_search" if ::Avo.configuration.feature_enabled?(:global_search) %>
    </div>


    <div class="flex m-1">

    <% hide_button = (action_name == "new" && controller_name == "issues") %>
    <% show_create_button = Current.user.can?(:create, Issue) && (action_name != "new" || controller_name != "issues") %>
    <% if  show_create_button %>
      <a data-target="create" class="button-component inline-flex flex-grow-0 items-center font-semibold leading-6 fill-current whitespace-nowrap transition duration-100 transform transition duration-100 cursor-pointer disabled:cursor-not-allowed disabled:opacity-70 border justify-center active:outline active:outline-1  rounded bg-primary-500 text-white border-primary-500 hover:bg-primary-600 hover:border-primary-600 active:border-primary-600 active:outline-primary-600 active:bg-primary-600 px-3 py-1.5 text-sm" href="/resources/issues/new"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class=" mr-1 h-4 my-1">
        <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v18m9-9H3"></path>
      </svg>
      <span>
      <%= I18n.t("activerecord.attributes.issue.new_issue")%>
      </span>
      </a>
    <% end %>

    </div>


    <div class="flex m-1">

    <div id="dropdownNotification" data-controller="navigation"  data-navigation-target="dropdownNotification" class="hidden z-20 w-full max-w-sm bg-white divide-y divide-gray-100 rounded-lg shadow dark:bg-gray-800 dark:divide-gray-700"
      aria-labelledby="dropdownNotificationButton" style="width: 400px; right: 10px;">
      <turbo-frame id="dropdownNotificationFrame" src="/resources/notifications/preview?turbo_frame=dropdownNotificationFrame" target="_top" class="block">
      </turbo-frame>
    </div>
      <%#= render Avo::SidebarProfileComponent.new user: Current.user
       %>
      <%
        avatar_source = "https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80"
        avatar_source = url_for(Current.user.avatar_icon) if Current.user.avatar.present?


      %>

      <div data-controller="navigation" class="absolute inset-y-0 right-0 flex items-center pr-2 sm:static sm:inset-auto sm:ml-6 sm:pr-0">
        <div data-action="click@window->navigation#outsideClick"></div>



<!--  Notifcation flowbite !-->
  <button id="dropdownNotificationButton" data-navigation-target="dropdownNotificationButton" data-action="navigation#updateDropdownNotificationFrame" data-dropdown-toggle="dropdownNotification" class="inline-flex items-center text-sm font-medium text-center text-gray-500 hover:text-gray-900 focus:outline-none dark:hover:text-white dark:text-gray-400" type="button">

    <svg class="w-6 h-6" aria-hidden="true" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
    <path d="M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z"></path></svg>
    <div class="relative flex <%='hidden' unless Current.user.unread_notifications?%>" id="notificationsIndicator">
      <div class="relative inline-flex w-3 h-3 bg-red-500 border-2 border-white rounded-full -top-2 right-3 dark:border-gray-900" style="width: 0.75rem; top: -5px;"></div>
    </div>

  </button>




        <!-- Profile dropdown -->
        <div class="relative ml-3">
          <div>
            <button data-navigation-target="profileButton" data-action="navigation#showProfileMenu" type="button"
            class="flex rounded-full bg-gray-800 text-sm focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800" id="user-menu-button" aria-expanded="false" aria-haspopup="true">
              <span class="sr-only">Open user menu</span>
              <img class="h-8 w-8 rounded-full" src="<%= avatar_source %>" alt="">
            </button>
          </div>
          <div data-navigation-target="profileMenuContainer" class="
          hidden absolute right-0 z-10 mt-2 w-72 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none
          divide-y divide-gray-100 rounded-lg shadow w-44 dark:bg-gray-700" role="menu" aria-orientation="vertical" aria-labelledby="user-menu-button" tabindex="-1">

<!-- component -->
                <div class="bg-white rounded overflow-hidden shadow-lg">
                    <div class="text-center p-6  bg-primary-500 border-b">

                    <p class="pt-2 text-lg font-semibold text-gray-50"><%=Current.user.name %></p>
                    <p class="text-sm text-gray-100"><%=Current.user.email %></p>
                    <div class="mt-2">
                        <a href="<%="/resources/users/#{Current.user.id}" %>" class="border rounded-md py-2 px-4 text-xs font-semibold text-white text-gray-100">
                        Profil
                        </a>
                    </div>
                    </div>
                    <div class="border-b">


                    <div class="py-1" role="none">
                    <%= button_to "/resources/global_settings",
                      method: :get,
                      class: "flex-1 flex items-center justify-left bg-white text-left cursor-pointer block px-4 py-1 w-full py-3 text-center rounded w-full",
                      form_class: 'flex-1' do %>
                      <%= helpers.svg 'tools' , class: 'h-4 mr-1' %>  <%= I18n.t("menus.settings.label") %>
                    <% end %>
                  </div>

                        <!--Link href="/account/donations" >
                            <a class="px-4 py-2 hover:bg-gray-100 flex">
                                <div class="text-gray-800">
                                <svg
                                    fill="none"
                                    stroke="currentColor"
                                    strokeLinecap="round"
                                    strokeLinejoin="round"
                                    strokeWidth="1"
                                    viewBox="0 0 24 24"
                                    class="w-5 h-5"
                                >
                                    <path d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                                </svg>
                                </div>
                                <div class="pl-3">
                                <p class="text-sm font-medium text-gray-800 leading-none">Donations</p>
                                <p class="text-xs text-gray-500">View your last donations</p>
                                </div>
                            </a>
                        </Link!-->
                    </div>
                </div>



            <%#= render RecloudCore::ProfileItemComponent.new label: 'Profil', path: "/resources/users/#{Current.user.id}", icon: 'user-circle'
            %>

            <div class="py-1" role="none">
              <%= button_to destroy_user_session_path,
                form: { "data-turbo" => "false" },
                method: :delete,
                data: {
                  confirm: t('avo.are_you_sure')
                },
                class: "flex-1 flex items-center justify-left bg-white text-left cursor-pointer text-red-600 font-semibold hover:bg-red-100 block px-4 py-1 w-full py-3 text-center rounded w-full",
                form_class: 'flex-1' do %>
                <%= helpers.svg 'logout', class: 'h-4 mr-1' %> <%= t('avo.sign_out') %>
              <% end %>
            </div>
            <!-- Active: "bg-gray-100", Not Active: "" -->
            <%# <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" role="menuitem" tabindex="-1" id="user-menu-item-0">Your Profile</a>
            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" role="menuitem" tabindex="-1" id="user-menu-item-1">Settings</a>
            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" role="menuitem" tabindex="-1" id="user-menu-item-2">Sign out</a> %>
          </div>
        </div>
      </div>








    </div>
  </div>
</div>
